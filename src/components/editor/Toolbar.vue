<!--
  å·¥å…·æ ç»„ä»¶
  åœ°å›¾æ ‡ç»˜ç¼–è¾‘å™¨é¡¶éƒ¨å·¥å…·æ ï¼Œåˆ†ç»„ä¸ºâ€œæ–‡ä»¶â€â€œç¼–è¾‘â€â€œå¯¹è±¡å˜æ¢â€â€œè§†å›¾â€â€œé…ç½®â€ï¼Œæ‰€æœ‰åŠŸèƒ½æŒ‰é’®å‡ä¸ºé¢„ç•™
-->

<script setup>
import { ref } from 'vue'
import EditorConfigDialog from '../dialog/EditorConfigDialog.vue'

/**
 * ç¼–è¾‘å™¨é…ç½®å¯¹è¯æ¡†æ˜¾ç¤ºçŠ¶æ€
 * @type {import('vue').Ref<boolean>}
 */
const showEditorConfig = ref(false)

/**
 * å½“å‰å¯¹è±¡å˜æ¢æ¨¡å¼
 * @type {import('vue').Ref<string>}
 */
const transformMode = ref('translate')

/**
 * æ˜¯å¦æœ‰é€‰ä¸­å¯¹è±¡ï¼ˆé¢„ç•™ï¼‰
 * @type {import('vue').Ref<boolean>}
 */
const hasSelection = ref(false)

/**
 * æ˜¯å¦å¯æ’¤é”€ï¼ˆé¢„ç•™ï¼‰
 * @type {import('vue').Ref<boolean>}
 */
const canUndo = ref(false)

/**
 * æ˜¯å¦å¯é‡åšï¼ˆé¢„ç•™ï¼‰
 * @type {import('vue').Ref<boolean>}
 */
const canRedo = ref(false)

/**
 * æ–°å»ºé¡¹ç›®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function newPlot() {
  // TODO: å®ç°æ–°å»ºé¡¹ç›®
}

/**
 * æš‚å­˜é¡¹ç›®åˆ°æœ¬åœ°ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function saveLocal() {
  // TODO: å®ç°æš‚å­˜åˆ°æœ¬åœ°
}

/**
 * ä¿å­˜é¡¹ç›®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function savePlot() {
  // TODO: å®ç°ä¿å­˜é¡¹ç›®
}

/**
 * åŠ è½½é¡¹ç›®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function loadPlot() {
  // TODO: å®ç°åŠ è½½é¡¹ç›®
}

/**
 * å¯¼å‡ºé¡¹ç›®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function exportPlot() {
  // TODO: å®ç°å¯¼å‡ºé¡¹ç›®
}

/**
 * å¯¼å…¥é¡¹ç›®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function importPlot() {
  // TODO: å®ç°å¯¼å…¥é¡¹ç›®
}

/**
 * æ’¤é”€æ“ä½œï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function undo() {
  // TODO: å®ç°æ’¤é”€
}

/**
 * é‡åšæ“ä½œï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function redo() {
  // TODO: å®ç°é‡åš
}

/**
 * å¤åˆ¶é€‰ä¸­å¯¹è±¡ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function duplicateSelected() {
  // TODO: å®ç°å¤åˆ¶
}

/**
 * åˆ é™¤é€‰ä¸­å¯¹è±¡ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function deleteSelected() {
  // TODO: å®ç°åˆ é™¤
}

/**
 * è®¾ç½®å¯¹è±¡å˜æ¢æ¨¡å¼ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 * @param {string} mode
 */
function setTransformMode(mode) {
  transformMode.value = mode
}

/**
 * èšç„¦åˆ°é€‰ä¸­å¯¹è±¡ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function focusSelected() {
  // TODO: å®ç°èšç„¦
}

/**
 * é‡ç½®ç›¸æœºï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function resetCamera() {
  // TODO: å®ç°é‡ç½®ç›¸æœº
}

/**
 * æ‰“å¼€ç¼–è¾‘å™¨é…ç½®ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
 */
function openEditorConfig() {
  showEditorConfig.value = true
}
</script>

<template>
  <div class="ribbon-toolbar dark">
    <div class="ribbon-content">
      <!-- æ–‡ä»¶åˆ†ç»„ -->
      <div class="ribbon-group">
        <div class="ribbon-group-title">æ–‡ä»¶</div>
        <div class="ribbon-group-buttons">
          <button class="ribbon-btn" @click="newPlot" title="æ–°å»ºé¡¹ç›®">
            <span class="icon">ğŸ“„</span>
            <div>æ–°å»º</div>
          </button>
          <button class="ribbon-btn" @click="saveLocal" title="æš‚å­˜åˆ°æœ¬åœ°">
            <span class="icon">ğŸ—„ï¸</span>
            <div>æš‚å­˜</div>
          </button>
          <button class="ribbon-btn" @click="savePlot" title="ä¿å­˜é¡¹ç›®">
            <span class="icon">ğŸ’¾</span>
            <div>ä¿å­˜</div>
          </button>
          <button class="ribbon-btn" @click="loadPlot" title="åŠ è½½é¡¹ç›®">
            <span class="icon">ğŸ“‚</span>
            <div>åŠ è½½</div>
          </button>
          <button class="ribbon-btn" @click="exportPlot" title="å¯¼å‡ºé¡¹ç›®">
            <span class="icon">ğŸ“¤</span>
            <div>å¯¼å‡º</div>
          </button>
          <button class="ribbon-btn" @click="importPlot" title="å¯¼å…¥é¡¹ç›®">
            <span class="icon">ğŸ“¥</span>
            <div>å¯¼å…¥</div>
          </button>
        </div>
      </div>
      <!-- ç¼–è¾‘åˆ†ç»„ -->
      <div class="ribbon-group">
        <div class="ribbon-group-title">ç¼–è¾‘</div>
        <div class="ribbon-group-buttons">
          <button class="ribbon-btn" @click="undo" :disabled="!canUndo" title="æ’¤é”€ (Ctrl+Z)">
            <span class="icon">â†¶</span>
            <div>æ’¤é”€</div>
          </button>
          <button class="ribbon-btn" @click="redo" :disabled="!canRedo" title="é‡åš (Ctrl+Y)">
            <span class="icon">â†·</span>
            <div>é‡åš</div>
          </button>
          <button class="ribbon-btn" @click="duplicateSelected" :disabled="!hasSelection" title="å¤åˆ¶ (Ctrl+D)">
            <span class="icon">ğŸ“‹</span>
            <div>å¤åˆ¶</div>
          </button>
          <button class="ribbon-btn danger" @click="deleteSelected" :disabled="!hasSelection" title="åˆ é™¤ (Delete)">
            <span class="icon">ğŸ—‘ï¸</span>
            <div>åˆ é™¤</div>
          </button>
        </div>
      </div>
      <!-- å¯¹è±¡å˜æ¢åˆ†ç»„ -->
      <div class="ribbon-group">
        <div class="ribbon-group-title">å¯¹è±¡å˜æ¢</div>
        <div class="ribbon-group-buttons">
          <button
            class="ribbon-btn"
            :class="{ active: transformMode === 'translate' }"
            @click="setTransformMode('translate')"
            :disabled="!hasSelection"
            title="ç§»åŠ¨å·¥å…· (G)"
          >
            <span class="icon">â†”ï¸</span>
            <div>ç§»åŠ¨</div>
          </button>
          <button
            class="ribbon-btn"
            :class="{ active: transformMode === 'rotate' }"
            @click="setTransformMode('rotate')"
            :disabled="!hasSelection"
            title="æ—‹è½¬å·¥å…· (R)"
          >
            <span class="icon">ğŸ”„</span>
            <div>æ—‹è½¬</div>
          </button>
          <button
            class="ribbon-btn"
            :class="{ active: transformMode === 'scale' }"
            @click="setTransformMode('scale')"
            :disabled="!hasSelection"
            title="ç¼©æ”¾å·¥å…· (S)"
          >
            <span class="icon">ğŸ“</span>
            <div>ç¼©æ”¾</div>
          </button>
        </div>
      </div>
      <!-- è§†å›¾åˆ†ç»„ -->
      <div class="ribbon-group">
        <div class="ribbon-group-title">è§†å›¾</div>
        <div class="ribbon-group-buttons">
          <button
            class="ribbon-btn"
            @click="focusSelected"
            :disabled="!hasSelection"
            title="èšç„¦åˆ°é€‰ä¸­å¯¹è±¡ (F)"
          >
            <span class="icon">ğŸ¯</span>
            <div>èšç„¦</div>
          </button>
          <button
            class="ribbon-btn"
            @click="resetCamera"
            title="é‡ç½®ç›¸æœº"
          >
            <span class="icon">ğŸ“·</span>
            <div>é‡ç½®ç›¸æœº</div>
          </button>
        </div>
      </div>
      <!-- é…ç½®åˆ†ç»„ -->
      <div class="ribbon-group">
        <div class="ribbon-group-title">é…ç½®</div>
        <div class="ribbon-group-buttons">
          <button class="ribbon-btn" @click="openEditorConfig" title="ç¼–è¾‘å™¨é…ç½®">
            <span class="icon">âš™ï¸</span>
            <div>ç¼–è¾‘å™¨</div>
          </button>
        </div>
      </div>
    </div>
<!-- ç¼–è¾‘å™¨é…ç½®å¯¹è¯æ¡† -->
<EditorConfigDialog v-model="showEditorConfig" />
  </div>
</template>

<style lang="scss" scoped>
.ribbon-toolbar.dark {
  background: #23272e;
  color: #f3f3f3;
  border-bottom: 1.5px solid #2d323a;
  padding: 0 12px;
  box-shadow: 0 2px 8px #0006;
  display: flex;
  flex-direction: column;
  width: 100%;
}

.ribbon-content {
  display: flex;
  flex-direction: row;
  gap: 4px;
  align-items: flex-end;
  padding: 4px;
  width: 100%;
  flex-wrap: wrap;
}

.ribbon-group {
  background: #282c34;
  border-radius: 8px 8px 0 0;
  border: 1.5px solid #353a42;
  box-shadow: 0 2px 8px #0003;
  padding: 4px;
  margin-right: 8px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  min-width: 120px;
  height: 80px;
  position: relative;
  box-sizing: border-box;
}

.ribbon-group-title {
  font-size: 13px;
  font-weight: bold;
  color: #7ecfff;
  margin-bottom: 4px;
  letter-spacing: 1px;
  text-shadow: 0 1px 2px #0008;
  width: 100%;
  text-align: center;
  box-sizing: border-box;
}

.ribbon-group-buttons {
  display: flex;
  flex-direction: row;
  gap: 4px;
  flex-wrap: wrap;
  align-items: flex-end;
  justify-content: flex-start;
}

.ribbon-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 4px 7px;
  background: #23272e;
  border: 1px solid #353a42;
  border-radius: 5px;
  color: #f3f3f3;
  font-size: 11px;
  cursor: pointer;
  margin-bottom: 6px;
  min-width: 48px;
  transition: background 0.2s, border 0.2s, color 0.2s;
}

.ribbon-btn:hover:not(:disabled) {
  background: #2d323a;
  border-color: #7ecfff;
  color: #fff;
}

.ribbon-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.ribbon-btn.active {
  background: #007acc;
  border-color: #0088dd;
  color: #fff;
}

.ribbon-btn.danger {
  background: #d73a49;
  border-color: #e85662;
  color: #fff;
}

.ribbon-btn.danger:hover:not(:disabled) {
  background: #e85662;
}

.icon {
  font-size: 18px;
  line-height: 1;
}

@media (max-width: 900px) {
  .ribbon-content {
    flex-wrap: wrap;
    gap: 12px;
  }
  .ribbon-group {
    min-width: 90px;
    padding: 8px 8px 10px 8px;
  }
  .ribbon-group-title {
    font-size: 12px;
    margin-bottom: 6px;
  }
  .ribbon-btn {
    min-width: 40px;
    font-size: 10px;
    padding: 5px 6px;
  }
  .icon {
    font-size: 15px;
  }
}
</style>
